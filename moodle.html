<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    SELECT u.firstname, u.lastname, c.id, c.fullname
    FROM mdl_course AS c
    JOIN mdl_context AS ctx ON c.id = ctx.instanceid
    JOIN mdl_role_assignments AS ra ON ra.contextid = ctx.id
    JOIN mdl_user AS u ON u.id = ra.userid
    WHERE u.id = 9


    SELECT u.firstname, u.lastname, u.email
    FROM mdl_role_assignments AS ra
    JOIN mdl_context AS context ON context.id = ra.contextid AND context.contextlevel = 50
    JOIN mdl_course AS c ON c.id = context.instanceid AND c.id = %%COURSEID%%
    JOIN mdl_user AS u ON u.id = ra.userid
    https://stackoverflow.com/questions/67793853/sql-statement-show-all-users-who-are-enrolled-in-a-moodle-course


    <!-- para ver los participantes de un  curso  -->
    SELECT username, idnumber,
firstname, lastname, email
FROM mdl_user_enrolments ue
JOIN mdl_enrol en ON ue.enrolid = en.id
JOIN mdl_user uu ON uu.id = ue.userid
WHERE en.courseid = 58

<!--  adnres -->

SELECT u.firstname, u.lastname, c.id, c.fullname, u.email, r.shortname
    FROM mdl_course AS c
    JOIN mdl_context AS ctx ON c.id = ctx.instanceid
    JOIN mdl_role_assignments AS ra ON ra.contextid = ctx.id
    JOIN mdl_user AS u ON u.id = ra.userid
    JOIN mdl_role r ON r.id = ra.roleid
        WHERE r.id IN (5)
        ORDER BY u.firstname, u.lastname
                                <!--        -->

<!--  -->

SELECT COUNT(DISTINCT lra.userid) AS learners, COUNT(DISTINCT tra.userid) as teachers
FROM mdl_course AS c #, mdl_course_categories AS cats
LEFT JOIN prefix_context AS ctx ON c.id = ctx.instanceid
JOIN mdl_role_assignments  AS lra ON lra.contextid = ctx.id
JOIN mdl_role_assignments  AS tra ON tra.contextid = ctx.id
JOIN mdl_course_categories AS cats ON c.category = cats.id
WHERE c.category = cats.id
AND (
	cats.path LIKE '%/CATEGORYID/%' #Replace CATEGORYID with the category id you want to count (eg: 80)
	OR cats.path LIKE '%/CATEGORYID'
	)
AND lra.roleid=5
AND tra.roleid=3


SELECT COUNT(DISTINCT lra.userid) AS learners, COUNT(DISTINCT tra.userid) as teachers
FROM mdl_course AS c #, mdl_course_categories AS cats
LEFT JOIN mdl_context AS ctx ON c.id = ctx.instanceid
JOIN mdl_role_assignments  AS lra ON lra.contextid = ctx.id
JOIN mdl_role_assignments  AS tra ON tra.contextid = ctx.id
JOIN mdl_course_categories AS cats ON c.category = cats.id
WHERE c.category = cats.id
AND (
	cats.path LIKE '%/80/%' #Replace CATEGORYID with the category id you want to count (eg: 80)
	OR cats.path LIKE '%/CATEGORYID'
	)
AND lra.roleid=5
AND tra.roleid=3

</body>
</html>